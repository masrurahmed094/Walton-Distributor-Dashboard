<div class="kpi-card-container">
  <div *ngIf="iconSvgPath" class="card-icon" [innerHTML]="iconSvgPath | safeHtml"></div>

  <div class="card-header">
    <h3 class="card-title">{{ title }}</h3>
  </div>

  <div class="card-content">
    <div *ngIf="isLoading" class="spinner-container">
      <mat-spinner diameter="40" color="accent"></mat-spinner>
    </div>

    <ng-container *ngIf="!isLoading">
      <div *ngIf="data; else noDataTemplate" class="value-container">
        
        <!-- START OF MODIFICATION -->
        <p class="kpi-value">
          <!-- Currency Format: Display BDT on a separate line -->
          <ng-container *ngIf="format === 'currency'">
            <span class="currency-symbol">BDT</span>
            <span class="currency-amount">{{ data.amount | number:'1.2-2' }}</span>
          </ng-container>

          <!-- Number Format: Display as a single number -->
          <ng-container *ngIf="format === 'number'">
            {{ data.amount | number }}
          </ng-container>
        </p>
        <!-- END OF MODIFICATION -->
        
        <div *ngIf="progressTotal" class="progress-bar-container">
          <mat-progress-bar 
            [value]="progressPercentage" 
            [color]="progressColor">
          </mat-progress-bar>
          <small class="progress-label">{{ progressPercentage | number:'1.0-0' }}% of target</small>
        </div>
      </div>

      <ng-template #noDataTemplate>
        <div class="no-data-value">-</div>
      </ng-template>
    </ng-container>
  </div>
</div>

